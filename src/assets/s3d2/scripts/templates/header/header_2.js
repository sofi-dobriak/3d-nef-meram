import get from 'lodash/get';
import $favourite from '../../../../s3d/scripts/modules/templates/header/$favourite';
import getConfig from '../../getConfig';
import {
  isDesktop,
  isDeviceHybrid,
  isFullScreenAvailable,
  isMobile,
} from '../../helpers/helpers_s3d2';
import ButtonIconLeft from '../common/ButtonIconLeft';
import ButtonIconRight from '../common/ButtonIconRight';
import IconButton from '../common/IconButton';
import navBar from './navBar';
import s3d2_navBar from './s3d2_navBar';

import s3d2_IconButton from '../common/s3d2_IconButton';
import $s3d2_ToggleButton from '../common/s3d2_ToggleButton';
import s3d2_ButtonIconRight from '../common/s3d2_ButtonIconRight';

function fullscreenMode(element) {
  if (element.requestFullscreen) {
    element.requestFullscreen();
  } else if (element.mozRequestFullScreen) {
    /* Firefox */
    element.mozRequestFullScreen();
  } else if (element.webkitRequestFullscreen) {
    /* Chrome, Safari & Opera */
    element.webkitRequestFullscreen();
  } else if (element.msRequestFullscreen) {
    /* IE/Edge */
    element.msRequestFullscreen();
  }
}

function exitFullscreenMode(element) {
  if (element.exitFullscreen) {
    element.exitFullscreen();
  } else if (element.mozCancelFullScreen) {
    element.mozCancelFullScreen();
  } else if (element.webkitExitFullscreen) {
    element.webkitExitFullscreen();
  } else if (element.msExitFullscreen) {
    element.msExitFullscreen();
  }
}

export default function header_2(i18n, { logo, menuSelector, config = {} }) {
  const $callback = document.documentElement.classList.contains('mobile')
    ? `
      <button class="s3d2-IconButton" data-open-form>
        <svg class="s3d2-IconButton__icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path fill-rule="evenodd" clip-rule="evenodd" d="M6.88978 4.53637C6.88976 4.53639 6.88974 4.53641 6.88972 4.53642L5.0702 6.26191C5.0702 6.26192 5.07019 6.26192 5.07019 6.26192C4.63931 6.67055 4.45268 7.1685 4.51028 7.8001C4.57038 8.45911 4.90032 9.28112 5.56562 10.2726L5.56564 10.2727C6.64022 11.8743 8.25549 13.4085 8.96717 14.0834L8.96725 14.0835C9.5765 14.6615 11.3846 16.3734 13.2814 17.4795C14.4837 18.1804 15.4843 18.5 16.2706 18.5C16.9001 18.5 17.4162 18.296 17.8329 17.9008L19.4733 16.3451L19.8174 16.7079L19.4733 16.3451C19.4939 16.3256 19.5 16.3067 19.5 16.2884C19.5 16.2689 19.4936 16.2508 19.4745 16.2327L19.4739 16.2321L16.1928 13.1206L16.5209 12.7747L16.1928 13.1206C16.1712 13.1002 16.1385 13.0847 16.0945 13.0847C16.0509 13.0847 16.0181 13.0999 15.9959 13.1209C15.9958 13.1209 15.9958 13.121 15.9957 13.121L14.0498 14.9664L13.7586 15.2425L13.426 15.018C12.4184 14.3379 11.4421 13.5514 10.5239 12.6806L10.5239 12.6806C9.72806 11.9259 8.99577 11.1262 8.34712 10.303L8.06476 9.94467L8.39579 9.63075L10.3675 7.76093L10.3675 7.76093C10.3886 7.74095 10.3945 7.72083 10.3945 7.7043C10.3945 7.68776 10.3886 7.66748 10.3673 7.64732C10.3673 7.64732 10.3673 7.64731 10.3673 7.6473L7.08659 4.53625L7.08658 4.53624C7.06415 4.51496 7.02993 4.49998 6.98835 4.49998C6.9468 4.49998 6.91243 4.51495 6.88978 4.53637ZM7.77469 3.81063C7.33781 3.39633 6.63887 3.39659 6.202 3.81045L6.20181 3.81064L4.38208 5.53631L4.38208 5.53632C3.71918 6.16498 3.43027 6.96821 3.51441 7.89092C3.59606 8.7862 4.02517 9.7716 4.73524 10.8298C5.87622 12.5304 7.56334 14.1303 8.27078 14.8012L8.27899 14.809L8.27907 14.809L8.28183 14.8117C8.88857 15.3873 10.7708 17.173 12.7776 18.3433L12.7777 18.3434C14.0532 19.0869 15.2336 19.5 16.2706 19.5C17.1404 19.5 17.9074 19.2083 18.521 18.6264L20.1614 17.0707C20.3763 16.867 20.5 16.5878 20.5 16.2884C20.5 15.9899 20.3775 15.7103 20.1616 15.5062C20.1615 15.5061 20.1614 15.506 20.1614 15.506L16.8809 12.395C16.667 12.1922 16.3854 12.0847 16.0945 12.0847C15.8034 12.0847 15.5222 12.1924 15.3084 12.3947L15.308 12.395L13.6558 13.9619C12.8117 13.3675 11.9909 12.6937 11.212 11.955C10.565 11.3414 9.96336 10.6983 9.41876 10.0388L11.0556 8.48654C11.5075 8.05798 11.5073 7.35062 11.0558 6.92206L11.0556 6.92187L7.7747 3.81064C7.77469 3.81063 7.77469 3.81063 7.77469 3.81063Z" fill="var(--s3d2-color-icon-gray-200)"/>
        </svg>
      </button>
    `
    : `
      <button class="s3d2-ButtonIconLeft--light" data-open-form>
        <svg class="s3d2-ButtonIconLeft__icon--no-paints" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
          <path d="M6.51538 2.53223C6.19556 2.45782 5.87951 2.52008 5.60229 2.6377C5.06161 2.86732 4.53589 3.36334 4.09351 3.92188C3.64181 4.49231 3.2343 5.18246 2.94507 5.86816C2.65987 6.54446 2.46951 7.26521 2.50269 7.88574V7.88672C2.675 11.0161 4.56544 14.3264 7.1189 16.8799C9.67242 19.4333 12.9826 21.3237 16.1121 21.4961C16.7322 21.5305 17.4533 21.3405 18.1296 21.0557C18.8154 20.7668 19.5052 20.359 20.0759 19.9072C20.6348 19.4648 21.1312 18.9396 21.3611 18.3984C21.4789 18.1209 21.5409 17.8045 21.4666 17.4844C21.3932 17.169 21.2009 16.9108 20.9285 16.7148L20.9089 16.6953L20.8601 16.665L17.072 14.3154H17.073C17.0212 14.2822 16.8753 14.206 16.7634 14.1494C16.7006 14.1177 16.6336 14.0849 16.5769 14.0586C16.5491 14.0457 16.5196 14.0318 16.4919 14.0205C16.48 14.0156 16.419 13.9895 16.3513 13.9775L16.3503 13.9785C15.673 13.8526 15.0593 14.1353 14.5466 14.46C14.2836 14.6266 14.0214 14.8213 13.7693 15.0107C13.5121 15.204 13.2634 15.3929 13.0076 15.5674V15.5684C12.9991 15.5742 12.9854 15.5816 12.9695 15.5889C12.9675 15.5898 12.9646 15.59 12.9626 15.5908C11.9179 14.9838 11.2647 14.4319 10.4138 13.5811C9.56249 12.7297 9.01179 12.0797 8.40503 11.0322C8.40597 11.0299 8.40687 11.0268 8.40796 11.0244L8.43237 10.9805C8.60548 10.7264 8.79264 10.4796 8.98413 10.2246C9.17349 9.97245 9.36835 9.70999 9.53491 9.44727C9.86061 8.93341 10.1445 8.31784 10.0154 7.6377C10.0027 7.57137 9.9768 7.51137 9.97241 7.50098C9.9612 7.47426 9.9482 7.44438 9.9353 7.41699C9.90911 7.36139 9.87602 7.29558 9.84448 7.2334C9.78312 7.11245 9.71417 6.98118 9.69312 6.94434L9.68823 6.93652L9.68433 6.92871L7.33374 3.13965L7.32886 3.13281L7.32495 3.12598V3.125H7.32397V3.12402L7.323 3.12305C7.32227 3.12203 7.32098 3.12047 7.32007 3.11914C7.31803 3.11616 7.31476 3.11132 7.31128 3.10645C7.30796 3.10179 7.30234 3.09356 7.29565 3.08496C7.29401 3.08296 7.29013 3.07938 7.28589 3.07422C7.09012 2.80024 6.8318 2.60599 6.51538 2.53223ZM6.28882 3.50586C6.33172 3.51586 6.40089 3.54636 6.48413 3.66895L6.49194 3.68066L8.83374 7.45605C8.83488 7.45817 8.83626 7.46123 8.83765 7.46387C8.84573 7.47896 8.85583 7.49943 8.86792 7.52246C8.89236 7.569 8.92337 7.62739 8.95288 7.68555C8.98258 7.74409 9.00993 7.80012 9.03003 7.84277C9.03276 7.84857 9.03563 7.85459 9.03784 7.85938C9.07866 8.14224 8.97127 8.46867 8.69019 8.91211C8.54757 9.13706 8.37523 9.36981 8.18433 9.62402C7.99719 9.87322 7.79196 10.1444 7.60132 10.4248L7.59644 10.4307C7.52554 10.5385 7.45652 10.6818 7.41968 10.8379C7.38563 10.9826 7.36135 11.223 7.49194 11.4521V11.4531C8.17226 12.6436 8.79202 13.3743 9.70679 14.2891C10.6219 15.2041 11.3549 15.8232 12.5408 16.5029L12.6257 16.5449C12.8257 16.6279 13.0255 16.607 13.155 16.5771C13.3129 16.5407 13.4594 16.4706 13.572 16.3936L13.571 16.3926C13.8503 16.2021 14.121 15.9975 14.3699 15.8105C14.6238 15.6198 14.8567 15.4473 15.0818 15.3047C15.5268 15.0229 15.8548 14.9153 16.1384 14.957C16.1436 14.9594 16.1494 14.9628 16.156 14.9658C16.1982 14.9854 16.2542 15.0126 16.3123 15.042C16.3695 15.0709 16.4266 15.1002 16.4714 15.124C16.4939 15.136 16.5128 15.1459 16.5261 15.1533C16.5288 15.1548 16.5311 15.1562 16.533 15.1572L16.5388 15.1611L20.3064 17.498L20.3259 17.5127L20.3289 17.5137V17.5146C20.4515 17.5981 20.4827 17.6675 20.4929 17.7109C20.5052 17.7641 20.5041 17.8582 20.4412 18.0068C20.3084 18.3196 19.9661 18.719 19.4558 19.123C18.957 19.5179 18.3447 19.8795 17.741 20.1338C17.1276 20.3921 16.5703 20.5194 16.1677 20.4971C13.37 20.3431 10.2779 18.6248 7.82593 16.1729C5.37401 13.7209 3.65467 10.6287 3.50073 7.83105C3.47949 7.42745 3.60766 6.86944 3.86597 6.25684C4.12071 5.65291 4.48285 5.04053 4.87769 4.54199C5.28183 4.03179 5.68158 3.69016 5.9939 3.55762C6.14263 3.49462 6.23617 3.49363 6.28882 3.50586ZM20.8894 16.6855L20.8914 16.6865L20.907 16.6982C20.9075 16.6987 20.9091 16.7009 20.9119 16.7031C20.9049 16.6982 20.8984 16.6923 20.8914 16.6875L20.8884 16.6855H20.8894Z" fill="var(--s3d2-color-icon-gray-200)"/>
        </svg>
        <span>
          ${i18n.t('ctr.nav.callback')}
        </span>
      </button>
    `;

  const $languageList = config.languages.split('/');
  document.documentElement.style.setProperty('--lang-count', $languageList.length);
  const $languageHandler =
    $languageList && $languageList.length > 1
      ? `
  <div class="lang-wrap">
    <ul class="language-list">
      ${$languageList
        .map(lang => {
          const isActive = document.querySelector('html').getAttribute('lang') === lang;
          return `
            <li data-lang="${lang}" style="${isActive ? 'pointer-events: none; order: -1;' : ''}">
              <a href="${window.location.origin}/${lang}/3d/${window.location.search}${
            window.location.hash
          }">
                ${lang}
              </a>
            </li>`;
        })
        .join('')}
    </ul>
  </div>`
      : '';
  setTimeout(() => {
    document.querySelectorAll('.language-list li').forEach(el => {
      el.addEventListener('click', e => {
        e.preventDefault();
        const lang = e.currentTarget.getAttribute('data-lang');
        window.location.href = `${window.location.origin}/${lang}/3d/${window.location.search}${window.location.hash}`;
      });
    });
  }, 100);
  const $phoneNumber = config.show_phoneNumber
    ? `<a class="s3d2-ButtonWithoutIcon" href="tel:${config.show_phoneNumber.replace(
        /[\s-]/g,
        '',
      )}"> ${config.show_phoneNumber}</a>`
    : '';
  document.body.addEventListener('click', e => {
    if (!e.target.closest('[data-fullscreen-mode]')) return;
    if (e.target.closest('[data-fullscreen-mode]') && !document.fullscreenElement) {
      fullscreenMode(document.documentElement);
    } else {
      exitFullscreenMode(document);
    }
    console.log('document.fullscreenElement', document.fullscreenElement);
  });
  document.body.addEventListener('click', e => {
    const langBtn = e.target.closest('[data-lang]');
    if (e.target.closest('[data-fullscreen-mode-off]') && document.fullscreenElement) {
      exitFullscreenMode(document);
    }
  });

  document.addEventListener('fullscreenchange', e => {
    document.querySelectorAll('[data-fullscreen-mode]').forEach(el => {
      el.classList.toggle('fullscreen', document.fullscreenElement);
    });
  });

  const currencyList = get(config, 'currency_list', []);
  const activeCurrency = new URLSearchParams(window.location.search).get('currency');

  document.body.addEventListener('click', e => {
    const themeWrapper = e.target.closest('.s3d2-theme-switch-wrapper');
    if (themeWrapper && !e.target.closest('label') && !e.target.closest('input')) {
      const themeCheckbox = themeWrapper.querySelector('#theme-switch');
      if (themeCheckbox) {
        themeCheckbox.checked = !themeCheckbox.checked;
      }
    }
  });

  return `
    <div class="header">
      <div class="header__left">
        ${s3d2_navBar(i18n, { logo })}
      </div>
      <div class="header__right">
      ${
        isMobile()
          ? ''
          : `<button class="s3d2-ButtonIconLeft s3d2-ButtonIconLeft--light" data-open-form="">
            <svg class="s3d2-ButtonIconLeft__icon--no-paints" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
              <path d="M6.51538 2.53223C6.19556 2.45782 5.87951 2.52008 5.60229 2.6377C5.06161 2.86732 4.53589 3.36334 4.09351 3.92188C3.64181 4.49231 3.2343 5.18246 2.94507 5.86816C2.65987 6.54446 2.46951 7.26521 2.50269 7.88574V7.88672C2.675 11.0161 4.56544 14.3264 7.1189 16.8799C9.67242 19.4333 12.9826 21.3237 16.1121 21.4961C16.7322 21.5305 17.4533 21.3405 18.1296 21.0557C18.8154 20.7668 19.5052 20.359 20.0759 19.9072C20.6348 19.4648 21.1312 18.9396 21.3611 18.3984C21.4789 18.1209 21.5409 17.8045 21.4666 17.4844C21.3932 17.169 21.2009 16.9108 20.9285 16.7148L20.9089 16.6953L20.8601 16.665L17.072 14.3154H17.073C17.0212 14.2822 16.8753 14.206 16.7634 14.1494C16.7006 14.1177 16.6336 14.0849 16.5769 14.0586C16.5491 14.0457 16.5196 14.0318 16.4919 14.0205C16.48 14.0156 16.419 13.9895 16.3513 13.9775L16.3503 13.9785C15.673 13.8526 15.0593 14.1353 14.5466 14.46C14.2836 14.6266 14.0214 14.8213 13.7693 15.0107C13.5121 15.204 13.2634 15.3929 13.0076 15.5674V15.5684C12.9991 15.5742 12.9854 15.5816 12.9695 15.5889C12.9675 15.5898 12.9646 15.59 12.9626 15.5908C11.9179 14.9838 11.2647 14.4319 10.4138 13.5811C9.56249 12.7297 9.01179 12.0797 8.40503 11.0322C8.40597 11.0299 8.40687 11.0268 8.40796 11.0244L8.43237 10.9805C8.60548 10.7264 8.79264 10.4796 8.98413 10.2246C9.17349 9.97245 9.36835 9.70999 9.53491 9.44727C9.86061 8.93341 10.1445 8.31784 10.0154 7.6377C10.0027 7.57137 9.9768 7.51137 9.97241 7.50098C9.9612 7.47426 9.9482 7.44438 9.9353 7.41699C9.90911 7.36139 9.87602 7.29558 9.84448 7.2334C9.78312 7.11245 9.71417 6.98118 9.69312 6.94434L9.68823 6.93652L9.68433 6.92871L7.33374 3.13965L7.32886 3.13281L7.32495 3.12598V3.125H7.32397V3.12402L7.323 3.12305C7.32227 3.12203 7.32098 3.12047 7.32007 3.11914C7.31803 3.11616 7.31476 3.11132 7.31128 3.10645C7.30796 3.10179 7.30234 3.09356 7.29565 3.08496C7.29401 3.08296 7.29013 3.07938 7.28589 3.07422C7.09012 2.80024 6.8318 2.60599 6.51538 2.53223ZM6.28882 3.50586C6.33172 3.51586 6.40089 3.54636 6.48413 3.66895L6.49194 3.68066L8.83374 7.45605C8.83488 7.45817 8.83626 7.46123 8.83765 7.46387C8.84573 7.47896 8.85583 7.49943 8.86792 7.52246C8.89236 7.569 8.92337 7.62739 8.95288 7.68555C8.98258 7.74409 9.00993 7.80012 9.03003 7.84277C9.03276 7.84857 9.03563 7.85459 9.03784 7.85938C9.07866 8.14224 8.97127 8.46867 8.69019 8.91211C8.54757 9.13706 8.37523 9.36981 8.18433 9.62402C7.99719 9.87322 7.79196 10.1444 7.60132 10.4248L7.59644 10.4307C7.52554 10.5385 7.45652 10.6818 7.41968 10.8379C7.38563 10.9826 7.36135 11.223 7.49194 11.4521V11.4531C8.17226 12.6436 8.79202 13.3743 9.70679 14.2891C10.6219 15.2041 11.3549 15.8232 12.5408 16.5029L12.6257 16.5449C12.8257 16.6279 13.0255 16.607 13.155 16.5771C13.3129 16.5407 13.4594 16.4706 13.572 16.3936L13.571 16.3926C13.8503 16.2021 14.121 15.9975 14.3699 15.8105C14.6238 15.6198 14.8567 15.4473 15.0818 15.3047C15.5268 15.0229 15.8548 14.9153 16.1384 14.957C16.1436 14.9594 16.1494 14.9628 16.156 14.9658C16.1982 14.9854 16.2542 15.0126 16.3123 15.042C16.3695 15.0709 16.4266 15.1002 16.4714 15.124C16.4939 15.136 16.5128 15.1459 16.5261 15.1533C16.5288 15.1548 16.5311 15.1562 16.533 15.1572L16.5388 15.1611L20.3064 17.498L20.3259 17.5127L20.3289 17.5137V17.5146C20.4515 17.5981 20.4827 17.6675 20.4929 17.7109C20.5052 17.7641 20.5041 17.8582 20.4412 18.0068C20.3084 18.3196 19.9661 18.719 19.4558 19.123C18.957 19.5179 18.3447 19.8795 17.741 20.1338C17.1276 20.3921 16.5703 20.5194 16.1677 20.4971C13.37 20.3431 10.2779 18.6248 7.82593 16.1729C5.37401 13.7209 3.65467 10.6287 3.50073 7.83105C3.47949 7.42745 3.60766 6.86944 3.86597 6.25684C4.12071 5.65291 4.48285 5.04053 4.87769 4.54199C5.28183 4.03179 5.68158 3.69016 5.9939 3.55762C6.14263 3.49462 6.23617 3.49363 6.28882 3.50586ZM20.8894 16.6855L20.8914 16.6865L20.907 16.6982C20.9075 16.6987 20.9091 16.7009 20.9119 16.7031C20.9049 16.6982 20.8984 16.6923 20.8914 16.6875L20.8884 16.6855H20.8894Z" fill="var(--s3d2-color-icon-gray-200)"/>
            </svg>

            <span>${i18n.t('ctr.nav.callback')}</span>
          </button>`
      }
       ${$phoneNumber}
       <div class="s3d2-IconButton-container">
          <!--<button class="s3d2-IconButton s3d2-IconButton--dark" data-s3d-voice="">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
              <path d="M19.5 10.4443C19.5001 10.1682 19.7239 9.94434 20 9.94434C20.2761 9.94434 20.4999 10.1682 20.5 10.4443L20.5 12.7773C20.5 13.0535 20.2761 13.2773 20 13.2773C19.7239 13.2773 19.5 13.0535 19.5 12.7773L19.5 10.4443ZM16.2998 6.55566C16.2998 6.27959 16.5238 6.05577 16.7998 6.05566C17.0759 6.05566 17.2998 6.27952 17.2998 6.55566L17.2998 16.667C17.2996 16.943 17.0758 17.167 16.7998 17.167C16.5239 17.1669 16.3 16.9429 16.2998 16.667L16.2998 6.55566ZM13.0996 8.88867C13.0997 8.61276 13.3237 8.38888 13.5996 8.38867C13.8757 8.38867 14.0995 8.61263 14.0996 8.88867L14.0996 14.333C14.0996 14.6091 13.8758 14.833 13.5996 14.833C13.3236 14.8328 13.0996 14.609 13.0996 14.333L13.0996 8.88867ZM9.90039 5C9.90039 4.72386 10.1242 4.5 10.4004 4.5C10.6764 4.50021 10.9004 4.72399 10.9004 5L10.9004 19C10.9004 19.276 10.6764 19.4998 10.4004 19.5C10.1242 19.5 9.90039 19.2761 9.90039 19L9.90039 5ZM6.70019 7.33301C6.70037 7.05702 6.92416 6.83301 7.20019 6.83301C7.47614 6.83311 7.70002 7.05708 7.70019 7.33301L7.7002 15.8887C7.7002 16.1647 7.47625 16.3886 7.2002 16.3887C6.92405 16.3887 6.7002 16.1648 6.7002 15.8887L6.70019 7.33301ZM3.5 10.4443C3.50006 10.1682 3.72389 9.94434 4 9.94434C4.27611 9.94434 4.49994 10.1682 4.5 10.4443L4.5 12.7773C4.5 13.0535 4.27614 13.2773 4 13.2773C3.72386 13.2773 3.5 13.0535 3.5 12.7773L3.5 10.4443Z" />
            </svg>
          </button>-->
          <button class="s3d2-IconButton s3d2-IconButton--dark" data-s3d-share="">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
              <path d="M16.293 6L13.5 6L13.5 5L18 5L18 9.5L17 9.5L17 6.70703L10.5205 13.1865L9.81348 12.4795L16.293 6ZM5 8.83301C5.00009 8.3469 5.19337 7.88085 5.53711 7.53711C5.88085 7.19337 6.34689 7.00009 6.83301 7L10.833 7L10.833 8L6.83301 8C6.61211 8.00009 6.40034 8.08794 6.24414 8.24414C6.08794 8.40034 6.00009 8.61211 6 8.83301L6 16.167C6.00009 16.3879 6.08794 16.5997 6.24414 16.7559C6.40034 16.9121 6.61211 16.9999 6.83301 17L14.167 17C14.3879 16.9999 14.5997 16.9121 14.7559 16.7559C14.9121 16.5997 14.9999 16.3879 15 16.167L15 12.167L16 12.167L16 16.167C15.9999 16.6531 15.8066 17.1192 15.4629 17.4629C15.1192 17.8066 14.6531 17.9999 14.167 18L6.83301 18C6.34689 17.9999 5.88085 17.8066 5.53711 17.4629C5.19337 17.1192 5.00009 16.6531 5 16.167L5 8.83301Z"/>
            </svg>
          </button>

          ${$favourite()}
          <div class="s3d2-theme-switch-wrapper" data-hide-elements="floor,flat,plannings,favourites">
            ${$s3d2_ToggleButton(i18n)}
          </div>
          ${$languageHandler}
          ${
            isDesktop() && isDeviceHybrid()
              ? `<button class="s3d2-IconButton " type="button" data-s3d-touch-mode-popup-open>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none">
              <circle cx="12" cy="12" r="3" stroke="#1C274C" stroke-width="1.5"/>
              <path fill="none" d="M13.7654 2.15224C13.3978 2 12.9319 2 12 2C11.0681 2 10.6022 2 10.2346 2.15224C9.74457 2.35523 9.35522 2.74458 9.15223 3.23463C9.05957 3.45834 9.0233 3.7185 9.00911 4.09799C8.98826 4.65568 8.70226 5.17189 8.21894 5.45093C7.73564 5.72996 7.14559 5.71954 6.65219 5.45876C6.31645 5.2813 6.07301 5.18262 5.83294 5.15102C5.30704 5.08178 4.77518 5.22429 4.35436 5.5472C4.03874 5.78938 3.80577 6.1929 3.33983 6.99993C2.87389 7.80697 2.64092 8.21048 2.58899 8.60491C2.51976 9.1308 2.66227 9.66266 2.98518 10.0835C3.13256 10.2756 3.3397 10.437 3.66119 10.639C4.1338 10.936 4.43789 11.4419 4.43786 12C4.43783 12.5581 4.13375 13.0639 3.66118 13.3608C3.33965 13.5629 3.13248 13.7244 2.98508 13.9165C2.66217 14.3373 2.51966 14.8691 2.5889 15.395C2.64082 15.7894 2.87379 16.193 3.33973 17C3.80568 17.807 4.03865 18.2106 4.35426 18.4527C4.77508 18.7756 5.30694 18.9181 5.83284 18.8489C6.07289 18.8173 6.31632 18.7186 6.65204 18.5412C7.14547 18.2804 7.73556 18.27 8.2189 18.549C8.70224 18.8281 8.98826 19.3443 9.00911 19.9021C9.02331 20.2815 9.05957 20.5417 9.15223 20.7654C9.35522 21.2554 9.74457 21.6448 10.2346 21.8478C10.6022 22 11.0681 22 12 22C12.9319 22 13.3978 22 13.7654 21.8478C14.2554 21.6448 14.6448 21.2554 14.8477 20.7654C14.9404 20.5417 14.9767 20.2815 14.9909 19.902C15.0117 19.3443 15.2977 18.8281 15.781 18.549C16.2643 18.2699 16.8544 18.2804 17.3479 18.5412C17.6836 18.7186 17.927 18.8172 18.167 18.8488C18.6929 18.9181 19.2248 18.7756 19.6456 18.4527C19.9612 18.2105 20.1942 17.807 20.6601 16.9999C21.1261 16.1929 21.3591 15.7894 21.411 15.395C21.4802 14.8691 21.3377 14.3372 21.0148 13.9164C20.8674 13.7243 20.6602 13.5628 20.3387 13.3608C19.8662 13.0639 19.5621 12.558 19.5621 11.9999C19.5621 11.4418 19.8662 10.9361 20.3387 10.6392C20.6603 10.4371 20.8675 10.2757 21.0149 10.0835C21.3378 9.66273 21.4803 9.13087 21.4111 8.60497C21.3592 8.21055 21.1262 7.80703 20.6602 7C20.1943 6.19297 19.9613 5.78945 19.6457 5.54727C19.2249 5.22436 18.693 5.08185 18.1671 5.15109C17.9271 5.18269 17.6837 5.28136 17.3479 5.4588C16.8545 5.71959 16.2644 5.73002 15.7811 5.45096C15.2977 5.17191 15.0117 4.65566 14.9909 4.09794C14.9767 3.71848 14.9404 3.45833 14.8477 3.23463C14.6448 2.74458 14.2554 2.35523 13.7654 2.15224Z" stroke="#1C274C" stroke-width="1.5"/>
            </svg>
          </button>`
              : ''
          }
          ${
            currencyList.length > 1 && config.show_prices
              ? `
            <div class="s3d-ctr__theme s3d-ctr__theme--currencies s3d-ctr__menu-3d-btn-style s3d-display">
              <input ${
                currencyList[1].value == activeCurrency ? 'checked' : ''
              } type="checkbox" class="s3d-ctr__switch" id="currency-switch">
              <label for="currency-switch">
                ${currencyList
                  .map(el => {
                    return `
                  <div data-currency-value="${el.value}">${el.value}</div>`;
                  })
                  .join('')}
              </label>
            </div>
          `
              : ''
          }
          ${
            isFullScreenAvailable()
              ? s3d2_IconButton('s3d2-IconButton--dark', '', 'data-fullscreen-mode', 'Full screen')
              : ''
          }
          ${
            isFullScreenAvailable()
              ? s3d2_IconButton(
                  's3d2-IconButton--dark',
                  '',
                  'data-fullscreen-mode-off',
                  'Cancel full screen',
                )
              : ''
          }

          ${
            menuSelector
              ? s3d2_ButtonIconRight('s3d2-ButtonIconRight--dark', `${menuSelector}`, '', 'Menu')
              : ''
          }
        </div>
       </div>
    </div>
  `;
}
